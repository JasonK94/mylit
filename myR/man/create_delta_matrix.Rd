% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_claude.R
\name{create_delta_matrix}
\alias{create_delta_matrix}
\title{Create Delta (Change Score) Matrix}
\usage{
create_delta_matrix(
  seurat_obj,
  config,
  assay = "RNA",
  slot = "data",
  subset_var = NULL,
  subset_value = NULL,
  aggregate_fun = function(x) mean(x, na.rm = TRUE)
)
}
\arguments{
\item{seurat_obj}{Seurat object.}

\item{config}{List. Configuration object.}

\item{assay}{String. Assay name (default "RNA").}

\item{slot}{String. Data slot (default "data").}

\item{subset_var}{String. Optional variable to subset by before calculation.}

\item{subset_value}{Value to filter subset_var by.}

\item{aggregate_fun}{Function to aggregate multiple AOIs per patient-timepoint.}
}
\value{
List with delta_matrix (genes x patients) and patient_metadata.
}
\description{
Alternative analysis approach that calculates per-patient change scores
(post - pre) for each gene. Useful for PCA, clustering, or when paired
analysis assumptions are violated.
}
\examples{
# Calculate change scores
delta_data <- create_delta_matrix(
  seurat_obj = sobj,
  config = config,
  subset_var = "ck",
  subset_value = "Positive"
)

# Use for downstream analysis
delta_sobj <- CreateSeuratObject(
  counts = delta_data$delta_matrix,
  meta.data = delta_data$patient_metadata
)
}
