% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots_heatmap.R
\name{plot_heatmap_genesets}
\alias{plot_heatmap_genesets}
\title{Heatmap: Gene Sets (Metadata-based)}
\usage{
plot_heatmap_genesets(
  data,
  features,
  group.by,
  split.by = NULL,
  aggregate = TRUE,
  aggregate_by = NULL,
  agg_fun = "mean",
  normalize = TRUE,
  assay = NULL,
  layer = "data",
  metadata_df = NULL,
  match_id = NULL,
  title = NULL,
  x_label = NULL,
  y_label = NULL,
  assign_celltype = FALSE,
  return_data = FALSE
)
}
\arguments{
\item{data}{Seurat object or data.frame}

\item{features}{Character vector. Gene set metadata column names}

\item{group.by}{Character. Grouping variable}

\item{split.by}{Character. Optional secondary grouping variable}

\item{aggregate}{Logical. Whether to aggregate cells (default: TRUE)}

\item{aggregate_by}{Character vector. Variables to aggregate by}

\item{agg_fun}{Character. Aggregation function (default: "mean")}

\item{normalize}{Logical. Apply z-score normalization (default: TRUE)}

\item{assay}{Character. Assay to use (Seurat only, not used for metadata)}

\item{layer}{Character. Layer to use (Seurat only, not used for metadata)}

\item{metadata_df}{Optional data.frame. Additional metadata}

\item{match_id}{Character. Column name in metadata_df for matching}

\item{title}{Character. Plot title}

\item{x_label}{Character. X-axis label}

\item{y_label}{Character. Y-axis label}

\item{assign_celltype}{Logical. Assign cell type based on highest gene set (default: FALSE)}

\item{return_data}{Logical. Return data instead of plot (default: FALSE)}
}
\value{
ggplot object or data.frame (if return_data=TRUE)
}
\description{
Creates a heatmap of gene set expression. Gene sets should be pre-computed
as metadata columns (e.g., using AddModuleScore or similar).
}
\examples{
\dontrun{
# Gene sets as metadata columns
sobj$T_cell_score <- AddModuleScore(...)
sobj$B_cell_score <- AddModuleScore(...)

p <- plot_heatmap_genesets(sobj, 
                            features = c("T_cell_score", "B_cell_score"),
                            group.by = "seurat_clusters")
}

}
