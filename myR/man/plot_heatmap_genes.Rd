% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots_heatmap.R
\name{plot_heatmap_genes}
\alias{plot_heatmap_genes}
\title{Heatmap: Gene Expression}
\usage{
plot_heatmap_genes(
  data,
  features,
  group.by,
  split.by = NULL,
  aggregate = TRUE,
  aggregate_by = NULL,
  agg_fun = "mean",
  normalize = TRUE,
  normalize_by = c("row", "column", "both"),
  normalize_transpose = FALSE,
  remove_na = FALSE,
  show_group_separator = TRUE,
  assay = NULL,
  layer = "data",
  metadata_df = NULL,
  match_id = NULL,
  title = NULL,
  x_label = NULL,
  y_label = NULL,
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  show_rownames = TRUE,
  show_colnames = TRUE,
  color_palette = NULL,
  return_data = FALSE
)
}
\arguments{
\item{data}{Seurat object or data.frame}

\item{features}{Character vector. Genes/features to plot}

\item{group.by}{Character. Grouping variable (e.g., "seurat_clusters", "cell_type")}

\item{split.by}{Character. Optional secondary grouping variable}

\item{aggregate}{Logical. Whether to aggregate cells (default: TRUE)}

\item{aggregate_by}{Character vector. Variables to aggregate by (default: group.by)}

\item{agg_fun}{Character. Aggregation function: "mean" (default), "sum", "median"}

\item{normalize}{Logical. Apply z-score normalization (default: TRUE)}

\item{normalize_by}{Character. Normalize by: "row" (genes), "column" (groups), "both" (default: "row")}

\item{assay}{Character. Assay to use (Seurat only)}

\item{layer}{Character. Layer to use: "counts", "data", "scale.data" (default: "data")}

\item{metadata_df}{Optional data.frame. Additional metadata to join}

\item{match_id}{Character. Column name in metadata_df for matching}

\item{title}{Character. Plot title}

\item{x_label}{Character. X-axis label (default: group.by)}

\item{y_label}{Character. Y-axis label (default: "Genes")}

\item{cluster_rows}{Logical. Cluster rows (default: FALSE)}

\item{cluster_cols}{Logical. Cluster columns (default: FALSE)}

\item{show_rownames}{Logical. Show row names (default: TRUE)}

\item{show_colnames}{Logical. Show column names (default: TRUE)}

\item{color_palette}{Character vector. Color palette (default: blue-white-red)}

\item{return_data}{Logical. Return data instead of plot (default: FALSE)}
}
\value{
ggplot object or data.frame (if return_data=TRUE)
}
\description{
Creates a heatmap of gene expression across groups (clusters, samples, etc.).
Supports z-score normalization and flexible grouping.
}
\examples{
\dontrun{
# Basic gene heatmap
p <- plot_heatmap_genes(sobj, features = c("CD3D", "CD4", "CD8A"), 
                        group.by = "seurat_clusters")

# With split.by
p <- plot_heatmap_genes(sobj, features = genes, group.by = "cell_type",
                         split.by = "condition")

# Return data
heatmap_data <- plot_heatmap_genes(sobj, features = genes, 
                                    group.by = "cluster", return_data = TRUE)
}

}
