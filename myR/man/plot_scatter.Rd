% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots_scatter.R
\name{plot_scatter}
\alias{plot_scatter}
\title{Scatter Plot: Expression vs Covariate}
\usage{
plot_scatter(
  data,
  feature,
  x_var,
  group.by = "sample_no",
  split.by = NULL,
  color_by = NULL,
  aggregate = TRUE,
  aggregate_by = NULL,
  transpose = FALSE,
  fitted_line = c("linear", "loess", "lasso"),
  each_fit = FALSE,
  show_stats = TRUE,
  stats_in_legend = FALSE,
  palette = NULL,
  transparency = TRUE,
  transparency_desc = FALSE,
  shape.group.by = NULL,
  remove_na = FALSE,
  label = FALSE,
  assay = NULL,
  layer = "data",
  metadata_df = NULL,
  match_id = NULL,
  point_size = 3,
  title = NULL,
  xlab = NULL,
  ylab = NULL
)
}
\arguments{
\item{data}{Seurat object or data.frame}

\item{feature}{Character. Gene/feature name to plot}

\item{x_var}{Character. Numeric covariate column name}

\item{group.by}{Character. Column to aggregate by (default: "sample_no")}

\item{split.by}{Character. Optional categorical variable to split/color by}

\item{color_by}{Character. Optional column to color points by}

\item{aggregate}{Logical. Whether to aggregate cells by group.by (default: TRUE)}

\item{transpose}{Logical. Swap x and y axes (default: FALSE)}

\item{fitted_line}{Character. Smoothing method: "linear", "loess", "lasso", or NULL}

\item{palette}{Character vector or palette name for colors}

\item{transparency}{Logical. Map numeric color_by to alpha (default: TRUE)}

\item{transparency_desc}{Logical. Inverse alpha mapping (default: FALSE)}

\item{remove_na}{Logical. Remove NA values in x_var and feature. To remove group, split, color variables, use subset. (default: FALSE)}

\item{assay}{Character. Assay to use (Seurat only)}

\item{layer}{Character. Layer to use: "counts", "data", "scale.data" (default: "data")}

\item{metadata_df}{Optional data.frame. Additional metadata to join}

\item{match_id}{Character. Column name in metadata_df for matching}

\item{point_size}{Numeric. Point size (default: 3)}

\item{title}{Character. Plot title (auto-generated if NULL)}

\item{xlab}{Character. X-axis label (auto-generated if NULL)}

\item{ylab}{Character. Y-axis label (auto-generated if NULL)}
}
\value{
ggplot object
}
\description{
Creates scatter plots of gene expression vs numeric covariates with optional
aggregation, coloring, and smoothing. Supports both Seurat objects and dataframes.
}
\examples{
\dontrun{
# Basic scatter plot
p <- plot_scatter(sobj, feature = "CD3D", x_var = "nih_change", group.by = "sample")

# With split.by
p <- plot_scatter(sobj, feature = "CD3D", x_var = "nih_change", 
                  split.by = "condition", fitted_line = "linear")

# With color_by
p <- plot_scatter(sobj, feature = "CD3D", x_var = "nih_change",
                  color_by = "age", palette = "viridis")
}

}
