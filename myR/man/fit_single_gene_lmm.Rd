% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_claude.R
\name{fit_single_gene_lmm}
\alias{fit_single_gene_lmm}
\title{Fit Linear Mixed Model for Single Gene}
\usage{
fit_single_gene_lmm(
  gene,
  expr_vector,
  metadata,
  formula_str,
  factor_cols = NULL,
  reference_levels = NULL
)
}
\arguments{
\item{gene}{String. Gene name.}

\item{expr_vector}{Numeric vector. Expression values for the gene.}

\item{metadata}{Data frame. Sample metadata.}

\item{formula_str}{String. Complete model formula (e.g.,
"Expression ~ drug * timepoint + (1|patient)").}

\item{factor_cols}{Character vector. Columns to convert to factors.}

\item{reference_levels}{Named list. Factor reference levels
(e.g., list(timepoint = "pre", drug = "Infliximab")).}
}
\value{
List with model results or error information.
}
\description{
Internal helper function that fits an lmer model for one gene. Handles
formula construction, factor releveling, and error catching.
}
\keyword{internal}
