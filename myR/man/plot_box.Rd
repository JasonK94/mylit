% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots_box.R
\name{plot_box}
\alias{plot_box}
\title{Boxplot: Cell-level or Aggregated}
\usage{
plot_box(
  data,
  features,
  group.by,
  split.by,
  idents = NULL,
  aggregate = FALSE,
  sample_col = NULL,
  aggregate_by = NULL,
  agg_fun = "mean",
  assay = NULL,
  layer = "data",
  metadata_df = NULL,
  match_id = NULL,
  ncol = 3,
  pt.size = NULL,
  violin = FALSE,
  add_stats = TRUE,
  ...
)
}
\arguments{
\item{data}{Seurat object or data.frame}

\item{features}{Character vector. Features to plot (genes or metadata)}

\item{group.by}{Character. Grouping variable for faceting}

\item{split.by}{Character. Splitting variable for x-axis}

\item{idents}{Character vector. Specific identities to include from group.by}

\item{aggregate}{Logical. Whether to aggregate cells (default: FALSE)}

\item{sample_col}{Character. Sample/patient ID column (required if aggregate=TRUE)}

\item{aggregate_by}{Character vector. Variables to aggregate by}

\item{agg_fun}{Character. Aggregation function: "mean" (default), "sum", "median"}

\item{assay}{Character. Assay to use (Seurat only)}

\item{layer}{Character. Layer to use: "counts", "data", "scale.data" (default: "data")}

\item{metadata_df}{Optional data.frame. Additional metadata to join}

\item{match_id}{Character. Column name in metadata_df for matching}

\item{ncol}{Integer. Number of columns for multi-feature plots (default: 3)}

\item{pt.size}{Numeric. Point size for jitter (0 to hide, default: 0.2 for cell, 1.0 for aggregated)}

\item{violin}{Logical. Overlay violin plot (default: FALSE)}

\item{add_stats}{Logical. Add statistical comparisons (default: TRUE)}

\item{...}{Additional arguments passed to stat_compare_means}
}
\value{
ggplot object (patchwork for multiple features)
}
\description{
Creates boxplots of features across groups. Supports both cell-level and
aggregated (pseudobulk) visualization.
}
\examples{
\dontrun{
# Cell-level boxplot
p <- plot_box(sobj, features = c("CD3D", "CD4"), 
              group.by = "cell_type", split.by = "condition")

# Aggregated boxplot
p <- plot_box(sobj, features = "CD3D", group.by = "cell_type",
               split.by = "condition", sample_col = "patient", aggregate = TRUE)
}

}
