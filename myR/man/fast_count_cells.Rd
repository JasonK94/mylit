% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_gpt.R
\name{fast_count_cells}
\alias{fast_count_cells}
\title{Fast neighborhood-by-sample counts using sparse matrix multiplication}
\usage{
fast_count_cells(milo, samples)
}
\arguments{
\item{milo}{A \code{Milo} object with neighborhoods already built.}

\item{samples}{Factor vector of length = ncol(milo) giving sample IDs
(e.g., patient IDs like \code{hos_no}).}
}
\value{
A matrix of neighborhood-by-sample cell counts (H × S).
}
\description{
Replaces miloR::countCells() with a vectorized sparse multiplication:
counts(H × S) = t(nhoods(cells × H)) \%*\% model.matrix(~0 + samples) (cells × S).
}
\examples{
counts <- fast_count_cells(milo, samples = factor(colData(milo)$hos_no))
}
