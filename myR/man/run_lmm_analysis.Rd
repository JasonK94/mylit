% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_claude.R
\name{run_lmm_analysis}
\alias{run_lmm_analysis}
\title{Run Linear Mixed Model Analysis for Multiple Genes}
\usage{
run_lmm_analysis(
  seurat_obj,
  genes = NULL,
  config = create_analysis_config(),
  fixed_effects = c("drug", "timepoint", "response"),
  interactions = c("drug:timepoint:response"),
  random_effects = "(1|patient)",
  reference_levels = list(timepoint = "pre"),
  n_cores = parallel::detectCores() - 1,
  verbose = TRUE
)
}
\arguments{
\item{seurat_obj}{Seurat object.}

\item{genes}{Character vector. Gene names to analyze. If NULL, uses all genes.}

\item{config}{List. Configuration from create_analysis_config().}

\item{fixed_effects}{Character vector. Fixed effect terms
(e.g., c("drug", "timepoint", "response")).}

\item{interactions}{Character vector. Interaction terms
(e.g., c("drug:timepoint", "drug:response:timepoint")).}

\item{random_effects}{String. Random effects formula (default: "(1|patient)").}

\item{reference_levels}{Named list. Reference levels for factors
(e.g., list(timepoint = "pre")).}

\item{n_cores}{Integer. Number of CPU cores for parallel processing.}

\item{verbose}{Logical. Print progress messages.}
}
\value{
A list with components:
\describe{
\item{results}{List of model results for each gene (includes lmerMod objects)}
\item{summary}{Tidy data frame with all model coefficients}
\item{converged_count}{Number of successfully fitted models}
\item{total_count}{Total number of genes attempted}
\item{formula}{The model formula used}
}
}
\description{
Main function for LMM analysis. Fits mixed-effects models to account for
patient-level random effects while testing fixed effects of treatment,
timepoint, and their interactions.
}
\examples{
# Full interaction model
lmm_res <- run_lmm_analysis(
  seurat_obj = sobj,
  genes = top_genes,
  config = config,
  fixed_effects = c("drug", "timepoint", "response"),
  interactions = c("drug:timepoint", "drug:response", 
                   "timepoint:response", "drug:timepoint:response"),
  reference_levels = list(timepoint = "pre", response = "NR")
)

# Simple pre-post comparison by drug
lmm_res <- run_lmm_analysis(
  seurat_obj = sobj,
  genes = top_genes,
  config = config,
  fixed_effects = c("drug", "timepoint"),
  interactions = c("drug:timepoint")
)
}
