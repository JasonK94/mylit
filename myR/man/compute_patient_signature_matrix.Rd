% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/patient_dim_reduction.R
\name{compute_patient_signature_matrix}
\alias{compute_patient_signature_matrix}
\title{Compute Patient-Level Signature Matrix from Module Scores}
\usage{
compute_patient_signature_matrix(
  seurat_obj,
  markers_df,
  background_genes = NULL,
  assay = NULL,
  sample_col = "hos_no",
  cluster_col = "anno3.scvi",
  top_n = 20,
  p_adj_cut = 0.05,
  min_genes = 5,
  score_prefix = "sig_",
  verbose = FALSE
)
}
\arguments{
\item{seurat_obj}{Seurat object with metadata columns \code{sample_col} and
\code{cluster_col}.}

\item{markers_df}{Data frame supplied to \code{make_cluster_signatures()}.}

\item{background_genes}{Optional character vector restricting the signature
universe; takes precedence over \code{seurat_obj} if provided.}

\item{assay}{Assay passed to \code{AddModuleScore} (defaults to \code{DefaultAssay}).}

\item{sample_col}{Column with sample/patient identifiers.}

\item{cluster_col}{Column with cluster identities.}

\item{top_n}{Number of genes to keep per cluster (sorted by logFC).}

\item{p_adj_cut}{Adjusted p-value threshold.}

\item{min_genes}{Minimum genes required to retain a cluster signature.}

\item{score_prefix}{Prefix passed to \code{AddModuleScore::name}.}

\item{verbose}{Logical; emit progress messages.}
}
\value{
List with \code{matrix}, \code{seurat_obj}, \code{map}, and \code{score_columns}.
}
\description{
Run \code{Seurat::AddModuleScore()} and aggregate the resulting signatures to
patient√ócluster means.
}
