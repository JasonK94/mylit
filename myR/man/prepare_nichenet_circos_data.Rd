% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CCI.R
\name{prepare_nichenet_circos_data}
\alias{prepare_nichenet_circos_data}
\title{Prepare Data for NicheNet Circos Plot}
\usage{
prepare_nichenet_circos_data(
  lr_network_top_df_large,
  best_upstream_ligands,
  seurat_obj = NULL,
  sender_celltypes = NULL,
  assay_name = "RNA",
  min_pct_expressed = 0.1,
  ligand_sender_map = NULL,
  circos_args = list()
)
}
\arguments{
\item{lr_network_top_df_large}{A data frame of ligand-receptor interactions,
typically from NicheNet analysis (e.g., \code{results$ligand_receptor_network_df}).
Must contain 'from' (ligand), 'to' (receptor), and 'weight' columns.}

\item{best_upstream_ligands}{A character vector of top N ligands to include.}

\item{seurat_obj}{A Seurat object (used if \code{ligand_sender_source} is "seurat_obj").}

\item{sender_celltypes}{Character vector of sender cell types (used if \code{ligand_sender_source} is "seurat_obj").}

\item{assay_name}{Name of the assay in Seurat object (used if \code{ligand_sender_source} is "seurat_obj").}

\item{min_pct_expressed}{Minimum percentage of cells in a sender type expressing a ligand
for it to be attributed to that sender (used if \code{ligand_sender_source} is "seurat_obj").}

\item{ligand_sender_map}{Optional. A named character vector where names are ligands
and values are their primary sender cell types. If provided, \code{seurat_obj},
\code{sender_celltypes}, etc., are ignored for sender mapping.}

\item{circos_args}{A list of additional arguments for customizing colors or palettes, e.g.,
\code{list(sender_palette_name = "Set1", receptor_color_name = "Set2", receptor_color_index = 1)}.}
}
\value{
A list containing:
\itemize{
\item \code{links_df}: Data frame for \code{chordDiagram} (origin, target, weight).
\item \code{sector_order}: Character vector defining the order of items in the circos plot.
\item \code{grid_cols_ordered}: Named character vector of colors for each sector.
\item \code{sender_palette_legend}: Named character vector for legend (sender type -> color).
\item \code{receptor_color_legend}: Named character vector for legend (receptor group -> color).
}
Returns NULL if essential input is missing or no valid links can be formed.
}
\description{
This function prepares the necessary data structures for generating a NicheNet
ligand-receptor circos plot. It identifies expressing sender cell types for
ligands and prepares link dataframes and color/order information.
}
