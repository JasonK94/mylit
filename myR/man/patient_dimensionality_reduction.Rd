% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/patient_dim_reduction.R
\name{patient_dimensionality_reduction}
\alias{patient_dimensionality_reduction}
\title{Patient-Level Dimensionality Reduction Pipeline}
\usage{
patient_dimensionality_reduction(
  seurat_obj,
  markers_df = NULL,
  signature_score_cols = NULL,
  include_frequency = TRUE,
  include_signatures = !is.null(markers_df) || !is.null(signature_score_cols),
  include_latent = TRUE,
  sample_col = "hos_no",
  cluster_col = "anno3.scvi",
  batch_var = "GEM",
  frequency_transform = c("clr", "alr", "ilr"),
  frequency_ref_idx = NULL,
  frequency_weight = 1.5,
  signature_weight = 1,
  latent_weight = 1,
  reduction = "integrated.scvi",
  latent_dims = NULL,
  latent_aggregator = mean,
  max_k = 50,
  max_umap_dims = 30,
  n_neighbors = 15,
  min_dist = 0.2,
  extra_plot_cols = c("g3", "nih_change"),
  verbose = FALSE,
  ...
)
}
\arguments{
\item{seurat_obj}{Seurat object containing columns \code{sample_col},
\code{cluster_col}, optional \code{batch_var}, and optional metadata for plotting
(e.g. \code{g3}, \code{nih_change}).}

\item{markers_df}{Optional \code{FindAllMarkers} result; required when
\code{include_signatures = TRUE} and \code{signature_score_cols} is NULL.}

\item{signature_score_cols}{Optional character vector of column names in
\code{seurat_obj@meta.data} containing pre-computed signature scores. If provided,
\code{markers_df} is ignored and these scores are used directly.}

\item{include_frequency}{Logical; include frequency view (default TRUE).}

\item{include_signatures}{Logical; include marker signatures (default TRUE
when \code{markers_df} is supplied or \code{signature_score_cols} is provided).}

\item{include_latent}{Logical; include latent reduction view (default TRUE).}

\item{sample_col, cluster_col}{Metadata columns for patient/cluster.}

\item{batch_var}{Batch column used in \code{removeBatchEffect}; set \code{NULL} to skip.}

\item{frequency_transform}{Transform method for frequency view: \code{"clr"} (default),
\code{"alr"}, or \code{"ilr"}.}

\item{frequency_ref_idx}{For ALR transform, column index to use as reference
(default: last column).}

\item{frequency_weight, signature_weight, latent_weight}{Numeric weights applied
to each view during block scaling.}

\item{reduction}{Reduction name for latent embeddings.}

\item{latent_dims}{Optional integer vector selecting latent dimensions.}

\item{latent_aggregator}{Function applied when aggregating latent embeddings.}

\item{max_k, max_umap_dims, n_neighbors, min_dist}{PCA/UMAP parameters.}

\item{extra_plot_cols}{Additional metadata columns to join onto the output
plotting data.frame.}

\item{verbose}{Logical; emit progress messages.}

\item{...}{Forwarded to \code{compute_patient_signature_matrix()}.}
}
\value{
List with embedding, plot_df, pca, combined_features, view_columns.
}
\description{
Assemble multi-view patient features (cluster frequencies, marker signatures,
latent embeddings), perform optional batch correction, and compute PCA+UMAP.
}
