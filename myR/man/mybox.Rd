% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots.R
\name{mybox}
\alias{mybox}
\title{Generate boxplots of average feature expression from a Seurat object.}
\usage{
mybox(
  sobj,
  features,
  sample_col,
  group.by,
  split.by,
  idents = NULL,
  assay = NULL,
  layer = NULL,
  ncol = 3,
  pt.size = 0,
  violin = FALSE
)
}
\arguments{
\item{sobj}{A Seurat object.}

\item{features}{A character vector of features to plot (genes or metadata column names).}

\item{sample_col}{Character string: the name of the metadata column identifying samples/patients.}

\item{group.by}{Character string: the name of the metadata column for primary grouping on the x-axis (e.g., clusters, cell types). If NULL, a single group "Overall" is used.}

\item{split.by}{Character string: the name of the metadata column for secondary grouping, creating side-by-side boxplots.}

\item{idents}{Optional: A character vector of values from the \code{group.by} column to include. If NULL, all values are shown.}

\item{assay}{Optional: Character string: the assay to use for gene features (e.g., "RNA", "SCT"). Defaults to the current default assay in \code{sobj}.}

\item{layer}{Optional: Character string: the layer to use for gene features ("counts", "data", "scale.data"). Defaults to "data", which \code{VlnPlot} typically uses.}

\item{ncol}{Integer: number of columns for arranging plots if multiple features are provided. Default is 3.}

\item{pt.size}{Numeric: size of points for individual sample averages. If 0, points are not shown. Default is 0.}

\item{violin}{Logical: whether to overlay violin plots. Default is FALSE.}
}
\value{
A ggplot object (created by \code{patchwork}) combining plots for all features.
}
\description{
This function calculates the average expression of specified features
(genes or metadata) per sample, grouped by a primary grouping variable
(e.g., cluster) and a secondary splitting variable. It then generates
boxplots showing the distribution of these sample averages.
}
\examples{
\dontrun{
# Assuming 'pbmc_small' is a Seurat object with 'RNA_snn_res.0.7' for clusters,
# 'letter.idents' for sample IDs (dummy), and 'groups' for a split.by condition.
# pbmc_small$sample <- sample(paste0("Patient", 1:4), ncol(pbmc_small), replace = TRUE)
# pbmc_small$condition <- sample(c("Control", "Treatment"), ncol(pbmc_small), replace = TRUE)

# Plot average CD3E expression per sample, grouped by cluster, split by condition
# mybox(pbmc_small,
#       features = "CD3E",
#       sample_col = "sample",
#       group.by = "seurat_clusters", # or another metadata column like cell type
#       split.by = "condition",
#       pt.size = 1,
#       violin = TRUE)

# Plot average nCount_RNA per sample, group.by is NULL (overall), split by condition
# mybox(pbmc_small,
#       features = "nCount_RNA",
#       sample_col = "sample",
#       group.by = NULL,
#       split.by = "condition",
#       pt.size = 1)
}
}
